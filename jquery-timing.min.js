(function(y,G){var M="__timeouts",A="__intervals",I="string",z=undefined,F="fx",o={},E=G.setTimeout,u=G.clearTimeout,f=G.setInterval,N=G.clearInterval;function D(P){return typeof P=="object"}function k(P){return typeof P=="function"}function h(P){return typeof P=="string"}function O(P){return typeof P=="number"}function v(R,Q){R=R||[];for(var P=0;P<R.length;P++){if(R[P]===Q){if(P<R.length-1){R[P]=R.pop();P--}else{R.pop()}}}return R}function H(Q,P){Q=Q||[];Q.push(P);return Q}function K(Q,V,S){var R={_isChainEnd:true,_trigger:{}},P={h:R,c:Q,_methodName:V,_methodArguments:S},U={_activeExecutionPoint:P,_ongoingLoops:[],_openEndLoopTimeout:E(function(){U._openEndLoopTimeout=false;C(U,R)},0)},T={};for(key in Q){if(k(Q[key])){(function(W){T[W]=function(){P=P.h={h:R,c:R.c,_methodName:W,_methodArguments:arguments};if(U._activeExecutionPoint._isChainEnd){U._activeExecutionPoint=P;C(U)}return T}})(key)}}C(U);return T}function C(S,U){if(U){U._trigger._isTriggered=true;if(S._activeExecutionPoint!=U){return}}for(var R,Q,T,P;R=S._activeExecutionPoint;){if(R._isChainEnd){if(S._ongoingLoops[0]&&!S._openEndLoopTimeout){S._activeExecutionPoint=S._ongoingLoops[0];S._activeExecutionPoint.d++;continue}break}P=R._trigger;if(P){if(P._isTriggered&&!P._isInterrupted){m(S)}else{break}}Q=R.c;T=Q[R._methodName];if(T==c){(P&&P._isTriggered?d:B)(S,R)}else{if(T==g){(P&&P._isTriggered?L:s)(S,R)}else{if(T==r){R.b=R._methodArguments[0];m(S)}else{if(T==x){(P&&P._isTriggered?b:p)(S,R)}else{if(T==i&&S._ongoingLoops[0]){if(j(S,R)){m(S);e(S)}else{S._activeExecutionPoint=S._ongoingLoops[0];S._activeExecutionPoint.d++;continue}}else{Q=T.apply(Q,R._methodArguments);m(S)}}}}}S._activeExecutionPoint.c=Q}}function m(Q,P){P=Q._activeExecutionPoint;if(k(P.b)){t(Q,P.c,P.b)}Q._activeExecutionPoint=P.h}function t(R,Q,S,P){P=[];y.each(R._ongoingLoops,function(){P.push(this.d)});return S.apply(Q,P)}function B(S,R,Q){function P(){C(S,R)}if(k(R._methodArguments[0])){R.b=R._methodArguments[0]}else{Q=R._methodArguments[0];R.b=R._methodArguments[1]}R._trigger=h(Q)?{_type:"event",_action:P,c:R.c.bind(Q,P),_value:Q}:{_type:"timer",_action:P,_value:E(P,Math.max(0,Q))};R.c.each(function(T,U){y(U).data(M,H(y(U).data(M),R._trigger))})}function w(P){if(P._type=="event"){P.c.unbind(P._value,P._action)}else{u(P._value)}P._isInterrupted=true}function d(Q,P){w(P._trigger);P.c.each(function(R,S){y(S).data(M,v(y(S).data(M),P._trigger))});P._trigger=z}function s(R,Q,P){if(k(Q._methodArguments[0])){Q.b=Q._methodArguments[0]}else{P=Q._methodArguments[0];Q.b=Q._methodArguments[1]}Q._trigger={};Q.c.queue(P==z?F:P,function(S){C(R,Q);S()})}function L(Q,P){P._trigger=z}function p(T,R,Q,S){function P(){C(T,R)}if(k(R._methodArguments[0])){R.b=R._methodArguments[0]}else{if(k(R._methodArguments[1])){Q=R._methodArguments[0];R.b=R._methodArguments[1]}else{Q=R._methodArguments[0];S=R._methodArguments[1];R.b=R._methodArguments[2]}}R._trigger=Q==z?{_isTriggered:true}:h(Q)?{_type:"event",_action:P,c:R.c.bind(Q,P),_value:Q,_isTriggered:S}:{_type:"timer",_action:P,_value:f(P,Math.max(0,Q)),_isTriggered:S};R.c.each(function(U,V){y(V).data(A,H(y(V).data(A),R._trigger))});R.d=0;T._ongoingLoops.unshift(R)}function b(Q,P){P._trigger._isTriggered=!P._trigger._type}function q(P){if(P._type=="event"){P.c.unbind(P._value,P._action)}if(P._type=="timer"){N(P._value)}P._isInterrupted=true}function e(Q,P){P=Q._ongoingLoops.shift();q(P._trigger);P.c.each(function(R,S){y(S).data(A,v(y(S).data(A),P._trigger))});P._trigger=z}function j(Q,P,R){R=P._methodArguments[0];if(R==z){R=!P.c.size()}if(k(R)){R=t(Q,P.c,R)}if(D(R)){R=R.toString()}return typeof R=="number"?Q._ongoingLoops[0].d>=R-1:R}function c(){return K(this,"wait",arguments)}function n(){return this.each(function(P){P=y(this).data(M);while(P&&P.length){w(P.pop())}})}function x(){return K(this,"repeat",arguments)}function a(){return this.each(function(P){P=y(this).data(A);while(P&&P.length){q(P.pop())}})}function i(){throw".until() method must be used after .repeat() only"}function r(P){P.apply(this);return this}function g(){return K(this,"join",arguments)}function l(P,R,Q){if(h(P)){Array.prototype.shift.apply(Q)}else{P=""}return R.apply(o[P]=(o[P]||y("<div>").text(P)),Q)}y.fn.extend({wait:c,unwait:n,repeat:x,unrepeat:a,until:i,then:r,join:g,$:y});y.extend({wait:function(P){return l(P,c,arguments)},unwait:function(P){return l(P,n,arguments)},repeat:function(P){return l(P,x,arguments)},unrepeat:function(P){return l(P,a,arguments)},then:function(P){return l(P,r,arguments)},join:function(P){return l(P,g,arguments)}});function J(S,Q){if(typeof S==I){S=new Function("x","return "+S)}var P=k(Q),T=k(S),R=function(U){if(arguments.length){R.value=U;if(P){Q(U)}}return R.toString()};R.toString=function(){var U=P?Q():R.value;return T?S(U):U};R.$={toString:R.toString};R.mod=function(U){return J(function(V){return V%U},R)};R.plus=function(U){return J(function(V){return V+U},R)};R.neg=function(){return J(function(U){return -U},R)};return R}G.$$=J})(jQuery,window);